<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>随机过程课后题第五章答案</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="style.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
  type="text/javascript"></script>
</head>
<body>
<h1 id="随机过程课后题第五章答案">随机过程课后题第五章答案</h1>
<h2
id="黑板上的题.-设-x_n-n-in-t-是一个齐次马尔可夫链-其状态空间-i-012-其一步转">（黑板上的题）.
设 <span class="math inline">\(\{X_n, n \in T\}\)</span>
是一个齐次马尔可夫链, 其状态空间 <span class="math inline">\(I =
\{0,1,2\}\)</span> , 其一步转</h2>
<p><span class="math inline">\(P = \begin{pmatrix} \frac{3}{4} &amp;
\frac{1}{4} &amp; 0 \\ \frac{1}{4} &amp; \frac{1}{2} &amp; \frac{1}{4}
\\ 0 &amp; \frac{3}{4} &amp; \frac{1}{4} \end{pmatrix}\)</span></p>
<p>移概率矩阵为 <span class="math inline">\(p_i(0) = p_i(X_0 =
i)\)</span> = <span class="math inline">\(\frac{1}{3}, \quad i =
0,1,2\)</span>, 求其初始状态的概率分布为：</p>
<ol type="1">
<li><p>求 <span class="math inline">\(P\{X_2=1\}\)</span> :</p></li>
<li><p>求 <span class="math inline">\(P\{X_{n+2}=2|X_n=1\}\)</span>
:</p></li>
<li><p>求 <span class="math inline">\(P\{X_0=1, X_1=2, X_2=1\}\)</span>
:</p></li>
<li><p>求 <span class="math inline">\(P\{X_{0}=2|X_1=1,X_2=0\}\)</span>
:</p></li>
<li><p>讨论此链是否具有遍历性. 若是遍历的求其极限分布.</p></li>
</ol>
<hr />
<h3 id="求-px_21">(1) 求 <span
class="math inline">\(P\{X_2=1\}\)</span></h3>
<p>这是求时刻 <span class="math inline">\(n=2\)</span>
时的<strong>绝对概率</strong>。 根据公式 <span
class="math inline">\(\pi_n = \pi_0 P^n\)</span> 或者 <span
class="math inline">\(\pi_{n} = \pi_{n-1} P\)</span>，我们可以先求出时刻
1 的分布，再求时刻 2。</p>
<p><strong>第一步：求时刻 1 的分布 <span
class="math inline">\(\pi_1\)</span></strong> <span
class="math display">\[
\begin{aligned}
P(X_1=1) &amp;= \sum_{i=0}^2 P(X_0=i) P(X_1=1 | X_0=i) \\
&amp;= \frac{1}{3} \times p_{01} + \frac{1}{3} \times p_{11} +
\frac{1}{3} \times p_{21} \\
&amp;= \frac{1}{3} \times \frac{1}{4} + \frac{1}{3} \times \frac{1}{2} +
\frac{1}{3} \times \frac{3}{4} \\
&amp;= \frac{1}{3} (\frac{1}{4} + \frac{2}{4} + \frac{3}{4}) =
\frac{1}{3} \times \frac{6}{4} = \frac{1}{2}
\end{aligned}
\]</span> 同理可算出其他两个状态（为了下一步计算）： <span
class="math inline">\(P(X_1=0) = \frac{1}{3}(p_{00}+p_{10}+p_{20}) =
\frac{1}{3}(\frac{3}{4}+\frac{1}{4}+0) = \frac{1}{3}\)</span> <span
class="math inline">\(P(X_1=2) = \frac{1}{3}(p_{02}+p_{12}+p_{22}) =
\frac{1}{3}(0+\frac{1}{4}+\frac{1}{4}) = \frac{1}{6}\)</span>
所以，<span class="math inline">\(\pi_1 = (\frac{1}{3}, \frac{1}{2},
\frac{1}{6})\)</span>。</p>
<p><strong>第二步：求时刻 2 状态为 1 的概率</strong> <span
class="math display">\[
\begin{aligned}
P(X_2=1) &amp;= \pi_1 \cdot (\text{P 的第1列}) \\
&amp;= P(X_1=0)p_{01} + P(X_1=1)p_{11} + P(X_1=2)p_{21} \\
&amp;= \frac{1}{3} \times \frac{1}{4} + \frac{1}{2} \times \frac{1}{2} +
\frac{1}{6} \times \frac{3}{4} \\
&amp;= \frac{1}{12} + \frac{1}{4} + \frac{3}{24} \\
&amp;= \frac{2}{24} + \frac{6}{24} + \frac{3}{24} \\
&amp;= \mathbf{\frac{11}{24}}
\end{aligned}
\]</span></p>
<p><strong>答案：</strong> <span class="math inline">\(P\{X_2=1\} =
\frac{11}{24}\)</span></p>
<hr />
<h3 id="求-px_n22x_n1">(2) 求 <span
class="math inline">\(P\{X_{n+2}=2|X_n=1\}\)</span></h3>
<p>这是求<strong>二步转移概率</strong> <span
class="math inline">\(p_{12}^{(2)}\)</span>。
由于是<strong>齐次</strong>马尔可夫链，转移概率只与时间差（步长）有关，与起始时刻
<span class="math inline">\(n\)</span> 无关。 <span
class="math inline">\(P\{X_{n+2}=2|X_n=1\} =
p_{12}^{(2)}\)</span>，即矩阵 <span class="math inline">\(P^2\)</span>
中第 1 行第 2 列的元素（注意下标从 0 开始，即中间行、最右列）。</p>
<p><span class="math display">\[
\begin{aligned}
p_{12}^{(2)} &amp;= \sum_{k=0}^2 p_{1k} p_{k2} \\
&amp;= p_{10}p_{02} + p_{11}p_{12} + p_{12}p_{22} \\
&amp;= (\frac{1}{4} \times 0) + (\frac{1}{2} \times \frac{1}{4}) +
(\frac{1}{4} \times \frac{1}{4}) \\
&amp;= 0 + \frac{1}{8} + \frac{1}{16} \\
&amp;= \frac{2}{16} + \frac{1}{16} \\
&amp;= \mathbf{\frac{3}{16}}
\end{aligned}
\]</span></p>
<p><strong>答案：</strong> <span
class="math inline">\(P\{X_{n+2}=2|X_n=1\} = \frac{3}{16}\)</span></p>
<hr />
<h3 id="求-px_01-x_12-x_21">(3) 求 <span class="math inline">\(P\{X_0=1,
X_1=2, X_2=1\}\)</span></h3>
<p>这是求马尔可夫链特定路径的<strong>联合概率</strong>。
利用马尔可夫性质（无后效性）和乘法公式： <span
class="math display">\[P(X_0, X_1, X_2) = P(X_0) \cdot P(X_1|X_0) \cdot
P(X_2|X_1)\]</span></p>
<p>代入具体状态 <span class="math inline">\(1 \to 2 \to 1\)</span>：
<span class="math display">\[
\begin{aligned}
P\{X_0=1, X_1=2, X_2=1\} &amp;= P(X_0=1) \cdot p_{12} \cdot p_{21} \\
&amp;= \frac{1}{3} \times \frac{1}{4} \times \frac{3}{4} \\
&amp;= \frac{3}{48} \\
&amp;= \mathbf{\frac{1}{16}}
\end{aligned}
\]</span></p>
<p><strong>答案：</strong> <span class="math inline">\(P\{X_0=1, X_1=2,
X_2=1\} = \frac{1}{16}\)</span></p>
<hr />
<h3 id="求-px_02x_11x_20">(4) 求 <span
class="math inline">\(P\{X_{0}=2|X_1=1,X_2=0\}\)</span></h3>
<h3 id="方法一利用定义硬算-最稳妥的方法">方法一：利用定义“硬算”
(最稳妥的方法)</h3>
<p>根据条件概率的定义公式 <span class="math inline">\(P(A|B) =
\frac{P(AB)}{P(B)}\)</span>：</p>
<p><span class="math display">\[
P(X_0=2 | X_1=1, X_2=0) = \frac{P(X_0=2, X_1=1, X_2=0)}{P(X_1=1, X_2=0)}
\]</span></p>
<p>我们需要分别算出分子和分母。</p>
<h4 id="分子特定路径-2-to-1-to-0-的联合概率">1. 分子：特定路径 <span
class="math inline">\(2 \to 1 \to 0\)</span> 的联合概率</h4>
<p>这就像我们在上一问做的一样，把路径上的概率乘起来： *
<strong>初始</strong>：<span class="math inline">\(P(X_0=2) =
\frac{1}{3}\)</span> * <strong>第一跳 (<span class="math inline">\(2 \to
1\)</span>)</strong>：<span class="math inline">\(p_{21} =
\frac{3}{4}\)</span> * <strong>第二跳 (<span class="math inline">\(1 \to
0\)</span>)</strong>：<span class="math inline">\(p_{10} =
\frac{1}{4}\)</span></p>
<p><span class="math display">\[
\text{分子} = \frac{1}{3} \times \frac{3}{4} \times \frac{1}{4} =
\frac{3}{48} = \frac{1}{16}
\]</span></p>
<h4 id="分母联合事件-x_11-x_20-的概率">2. 分母：联合事件 <span
class="math inline">\(X_1=1, X_2=0\)</span> 的概率</h4>
<p>这一步我们可以利用第(1)问算出的结果。 第(1)问中我们算出了时刻 1
的分布 <span class="math inline">\(\pi_1\)</span>，其中 <span
class="math inline">\(P(X_1=1) = \frac{1}{2}\)</span>。</p>
<p>根据乘法公式： <span class="math display">\[
\begin{aligned}
P(X_1=1, X_2=0) &amp;= P(X_1=1) \times P(X_2=0 | X_1=1) \\
&amp;= P(X_1=1) \times p_{10} \\
&amp;= \frac{1}{2} \times \frac{1}{4} \\
&amp;= \frac{1}{8}
\end{aligned}
\]</span></p>
<h4 id="相除求结果">3. 相除求结果</h4>
<p><span class="math display">\[
\text{结果} = \frac{\text{分子}}{\text{分母}} = \frac{1/16}{1/8} =
\frac{1}{16} \times 8 = \mathbf{\frac{1}{2}}
\]</span></p>
<hr />
<h3
id="方法二利用马尔可夫性质简化-高阶技巧">方法二：利用马尔可夫性质简化
(高阶技巧)</h3>
<p>如果你深入理解马尔可夫性，你会发现：<strong><span
class="math inline">\(X_2=0\)</span> 这个条件其实是多余的。</strong></p>
<p><strong>为什么？</strong>
马尔可夫链的特点是“过去”和“未来”通过“现在”被隔断了。 * 链条结构：<span
class="math inline">\(X_0 \to X_1 \to X_2\)</span> * 一旦 <strong><span
class="math inline">\(X_1\)</span>（现在）</strong> 已知，那么 <span
class="math inline">\(X_0\)</span>（过去）和 <span
class="math inline">\(X_2\)</span>（未来）就是相互独立的。 *
通俗地说：只要知道你昨天在“北京” (<span
class="math inline">\(X_1=1\)</span>)，那么你今天飞去了“上海” (<span
class="math inline">\(X_2=0\)</span>)
这件事，对于推断你前天是不是在“广州” (<span
class="math inline">\(X_0=2\)</span>) 没有提供任何额外信息。</p>
<p><strong>数学推导：</strong> <span class="math display">\[
P(X_0=2 | X_1=1, X_2=0) = P(X_0=2 | X_1=1)
\]</span>
<em>(注：这叫“马尔可夫性的逆向应用”，给定现在，未来不影响对过去的推断)</em></p>
<p><strong>验证计算 <span class="math inline">\(P(X_0=2 |
X_1=1)\)</span>：</strong> <span class="math display">\[
\begin{aligned}
P(X_0=2 | X_1=1) &amp;= \frac{P(X_0=2, X_1=1)}{P(X_1=1)} \\
&amp;= \frac{P(X_0=2) \cdot p_{21}}{P(X_1=1)} \\
&amp;= \frac{\frac{1}{3} \times \frac{3}{4}}{\frac{1}{2}} \\
&amp;= \frac{\frac{1}{4}}{\frac{1}{2}} \\
&amp;= \mathbf{\frac{1}{2}}
\end{aligned}
\]</span></p>
<p>结果完全一致！</p>
<hr />
<h3 id="讨论此链是否具有遍历性.-若是遍历的求其极限分布.">(5)
讨论此链是否具有遍历性. 若是遍历的求其极限分布.</h3>
<p><strong>第一步：讨论遍历性</strong>
一个有限状态的马尔可夫链具有遍历性（Ergodicity），通常需要满足两个条件：<strong>不可约（Irreducible）</strong>
和 <strong>非周期（Aperiodic）</strong>。</p>
<ol type="1">
<li><strong>不可约性</strong>： 观察转移矩阵 <span
class="math inline">\(P\)</span>：
<ul>
<li><span class="math inline">\(0 \to 1\)</span> (<span
class="math inline">\(p_{01}&gt;0\)</span>), <span
class="math inline">\(1 \to 0\)</span> (<span
class="math inline">\(p_{10}&gt;0\)</span>) <span
class="math inline">\(\Rightarrow\)</span> 0与1互通。</li>
<li><span class="math inline">\(1 \to 2\)</span> (<span
class="math inline">\(p_{12}&gt;0\)</span>), <span
class="math inline">\(2 \to 1\)</span> (<span
class="math inline">\(p_{21}&gt;0\)</span>) <span
class="math inline">\(\Rightarrow\)</span> 1与2互通。</li>
<li>所以所有状态 <span class="math inline">\(\{0, 1, 2\}\)</span>
都是互通的，该链是不可约的。</li>
</ul></li>
<li><strong>非周期性</strong>： 查看对角线元素，<span
class="math inline">\(p_{00} = 3/4 &gt; 0\)</span>，<span
class="math inline">\(p_{11} = 1/2 &gt; 0\)</span>。
只要状态有自环（一步能回到自己），该状态的周期就是
1。不可约链中所有状态周期相同，故该链是非周期的。</li>
</ol>
<p><strong>结论</strong>：该链是有限状态、不可约、非周期的马尔可夫链，因此<strong>具有遍历性</strong>，存在唯一的平稳分布（极限分布）。</p>
<p><strong>第二步：求极限分布</strong> 设极限分布为 <span
class="math inline">\(\pi = (\pi_0, \pi_1, \pi_2)\)</span>，则 <span
class="math inline">\(\pi\)</span> 满足平稳方程 <span
class="math inline">\(\pi P = \pi\)</span> 且 <span
class="math inline">\(\sum \pi_i = 1\)</span>。</p>
<p>列出方程组： <span class="math display">\[
\begin{cases}
\frac{3}{4}\pi_0 + \frac{1}{4}\pi_1 + 0\pi_2 = \pi_0 \quad
&amp;\text{(1)} \\
\frac{1}{4}\pi_0 + \frac{1}{2}\pi_1 + \frac{3}{4}\pi_2 = \pi_1 \quad
&amp;\text{(2)} \\
0\pi_0 + \frac{1}{4}\pi_1 + \frac{1}{4}\pi_2 = \pi_2 \quad
&amp;\text{(3)} \\
\pi_0 + \pi_1 + \pi_2 = 1 \quad &amp;\text{(4)}
\end{cases}
\]</span></p>
<p>解方程： 由 (1) 得：<span class="math inline">\(\frac{1}{4}\pi_1 =
\frac{1}{4}\pi_0 \Rightarrow \mathbf{\pi_0 = \pi_1}\)</span> 由 (3)
得：<span class="math inline">\(\frac{1}{4}\pi_1 = \frac{3}{4}\pi_2
\Rightarrow \mathbf{\pi_1 = 3\pi_2}\)</span></p>
<p>综上关系：<span class="math inline">\(\pi_0 = 3\pi_2, \quad \pi_1 =
3\pi_2\)</span>。</p>
<p>代入归一化条件 (4)： <span class="math display">\[3\pi_2 + 3\pi_2 +
\pi_2 = 1\]</span> <span class="math display">\[7\pi_2 = 1 \Rightarrow
\mathbf{\pi_2 = \frac{1}{7}}\]</span></p>
<p>回代求得： <span class="math inline">\(\pi_1 = \frac{3}{7}\)</span>
<span class="math inline">\(\pi_0 = \frac{3}{7}\)</span></p>
<p><strong>答案：</strong> 该链具有遍历性。其极限分布为 <span
class="math inline">\(\pi = (\frac{3}{7}, \frac{3}{7},
\frac{1}{7})\)</span>。</p>
<hr />
<h2 id="section">1</h2>
<p>判定一个随机过程 <span class="math inline">\(\{X_n\}\)</span>
是否是马尔可夫链（马氏链），核心标准是看它是否具有<strong>“无后效性”</strong>。</p>
<p>即：推断<strong>“未来”</strong>（<span
class="math inline">\(X_{n+1}\)</span>）的概率分布，在已知<strong>“现在”</strong>（<span
class="math inline">\(X_n\)</span>）的情况下，是否还需要参考<strong>“过去”</strong>（<span
class="math inline">\(X_{n-1}, \cdots, X_1\)</span>）的信息？ *
如果<strong>只需要“现在”</strong>就能完全决定“未来”的分布，则是马氏链。
* 如果<strong>还需要“过去”</strong>来辅助判断，则不是。</p>
<p>我们利用递推关系式法来分别讨论。</p>
<hr />
<h3 id="x_n-u_1-u_2-cdots-u_n">(1) <span class="math inline">\(X_n = U_1
+ U_2 + \cdots + U_n\)</span></h3>
<p><strong>结论：是马尔可夫链。</strong></p>
<p><strong>证明过程：</strong></p>
<ol type="1">
<li><p><strong>寻找递推关系</strong>： 我们可以将 <span
class="math inline">\(X_{n+1}\)</span> 写成 <span
class="math inline">\(X_n\)</span> 的函数： <span
class="math display">\[
\begin{aligned}
X_{n+1} &amp;= \underbrace{U_1 + U_2 + \cdots + U_n}_{X_n} + U_{n+1} \\
X_{n+1} &amp;= X_n + U_{n+1}
\end{aligned}
\]</span></p></li>
<li><p><strong>分析依赖性</strong>：</p></li>
</ol>
<ul>
<li><span class="math inline">\(X_{n+1}\)</span> 的值取决于当前状态
<span class="math inline">\(X_n\)</span> 和新的增量 <span
class="math inline">\(U_{n+1}\)</span>。</li>
<li>题目已知 <span class="math inline">\(\{U_n\}\)</span>
是<strong>相互独立</strong>的随机变量序列。</li>
<li>这意味着，新的增量 <span class="math inline">\(U_{n+1}\)</span>
独立于过去的所有的 <span class="math inline">\(U_1, \dots,
U_n\)</span>。</li>
<li>因为过去的某些状态 <span class="math inline">\(X_{n-1}, \dots,
X_1\)</span> 只是 <span class="math inline">\(U_1, \dots,
U_{n-1}\)</span> 的组合，所以 <span
class="math inline">\(U_{n+1}\)</span> 也独立于过去的所有状态 <span
class="math inline">\((X_1, \dots, X_n)\)</span>。</li>
</ul>
<ol start="3" type="1">
<li><strong>结论</strong>： 当我们已知“现在”的状态 <span
class="math inline">\(X_n = x_n\)</span> 时，“未来” <span
class="math inline">\(X_{n+1} = x_n + U_{n+1}\)</span> 的分布完全由
<span class="math inline">\(U_{n+1}\)</span>
的分布决定，与“过去”的历史路径无关。 满足马尔可夫性： <span
class="math display">\[P(X_{n+1} | X_n, X_{n-1}, \dots, X_1) = P(X_{n+1}
| X_n)\]</span></li>
</ol>
<p>这就是典型的<strong>随机游走（Random
Walk）</strong>模型，它是最经典的马尔可夫链之一。</p>
<hr />
<h3 id="x_n-u_1-u_2-cdots-u_n2">(2) <span class="math inline">\(X_n =
(U_1 + U_2 + \cdots + U_n)^2\)</span></h3>
<p><strong>结论：一般情况下不是马尔可夫链。</strong>
<em>(只有在特殊情况下，如 <span class="math inline">\(U_n\)</span>
的分布关于 0 对称时，才可能是)</em></p>
<p><strong>分析与反例：</strong></p>
<ol type="1">
<li><p><strong>寻找递推关系</strong>： 令 <span
class="math inline">\(S_n = U_1 + \cdots +
U_n\)</span>（即第一问中的随机游走），则 <span class="math inline">\(X_n
= S_n^2\)</span>。 <span class="math display">\[
\begin{aligned}
X_{n+1} &amp;= S_{n+1}^2 = (S_n + U_{n+1})^2 \\
X_{n+1} &amp;= S_n^2 + 2S_n U_{n+1} + U_{n+1}^2 \\
X_{n+1} &amp;= X_n + 2S_n U_{n+1} + U_{n+1}^2
\end{aligned}
\]</span></p></li>
<li><p><strong>发现问题</strong>： 要确定 <span
class="math inline">\(X_{n+1}\)</span> 的分布，我们需要知道 <span
class="math inline">\(X_n\)</span> 和 <strong><span
class="math inline">\(S_n\)</span> 的正负号</strong>。</p></li>
</ol>
<ul>
<li>已知 <span class="math inline">\(X_n\)</span> (即 <span
class="math inline">\(S_n^2\)</span>)，我们只能算出 <span
class="math inline">\(|S_n|\)</span> 的绝对值，但<strong>不知道 <span
class="math inline">\(S_n\)</span> 到底是正还是负</strong>。</li>
<li>然而，中间项 <span class="math inline">\(2S_n U_{n+1}\)</span>
的值显然取决于 <span class="math inline">\(S_n\)</span> 的符号。</li>
<li>这时候，“过去”的信息（<span
class="math inline">\(X_{n-1}\)</span>）可能会帮助我们推断出 <span
class="math inline">\(S_n\)</span> 的符号，从而改变对未来的预测。</li>
</ul>
<ol start="3" type="1">
<li><strong>举反例证明（非马氏性）</strong>： 设 <span
class="math inline">\(U_n\)</span> 取值非对称，例如：<span
class="math inline">\(P(U_n = 1) = \frac{2}{3}, P(U_n = -1) =
\frac{1}{3}\)</span>。</li>
</ol>
<p>假设当前状态 <strong><span class="math inline">\(X_n =
1\)</span></strong>。这意味着 <span class="math inline">\(S_n\)</span>
可能是 <span class="math inline">\(1\)</span> 或 <span
class="math inline">\(-1\)</span>。 我们需要预测下一时刻 <strong><span
class="math inline">\(X_{n+1} = 0\)</span></strong> 的概率。 注：<span
class="math inline">\(X_{n+1}=0\)</span> 意味着 <span
class="math inline">\((S_n + U_{n+1})^2 = 0\)</span>，即 <span
class="math inline">\(U_{n+1} = -S_n\)</span>。</p>
<ul>
<li><p><strong>情况 A：如果历史告诉我们 <span class="math inline">\(S_n
= 1\)</span></strong> （例如通过 <span
class="math inline">\(X_{n-1}\)</span> 推断出来的）。 要跳到 0，需要
<span class="math inline">\(U_{n+1} = -1\)</span>。 概率为：<span
class="math inline">\(P(U_{n+1}=-1) =
\mathbf{\frac{1}{3}}\)</span>。</p></li>
<li><p><strong>情况 B：如果历史告诉我们 <span class="math inline">\(S_n
= -1\)</span></strong>。 要跳到 0，需要 <span
class="math inline">\(U_{n+1} = 1\)</span>。 概率为：<span
class="math inline">\(P(U_{n+1}=1) =
\mathbf{\frac{2}{3}}\)</span>。</p></li>
</ul>
<p><strong>显而易见</strong>： 虽然“现在”的状态都是 <span
class="math inline">\(X_n=1\)</span>，但如果你知道“过去”的信息导致判定
<span class="math inline">\(S_n\)</span>
符号不同，预测“未来”的概率（<span class="math inline">\(1/3\)</span> vs
<span class="math inline">\(2/3\)</span>）就不同了。</p>
<p><span class="math display">\[P(X_{n+1}|X_n, X_{n-1}) \neq
P(X_{n+1}|X_n)\]</span></p>
<p>所以，一般情况下它<strong>不是</strong>马尔可夫链。</p>
<p><strong>补充说明（特殊情况）：</strong> 如果 <span
class="math inline">\(U_n\)</span> 的分布是<strong>关于 0
对称</strong>的（例如取 <span class="math inline">\(\pm 1\)</span>
的概率都是 <span class="math inline">\(0.5\)</span>），那么 <span
class="math inline">\(S_n\)</span> 为正或为负时，下一步 <span
class="math inline">\(X_{n+1}\)</span>
的分布是一样的（因为对称性消除了符号的影响）。在这种特殊情况下，它会变成马氏链。但题目问的是一般情况，答案应为<strong>否</strong>。</p>
<hr />
<h2 id="section-1">2</h2>
<p>要证明随机差分方程 <span class="math inline">\(X_n = \rho X_{n-1} +
I_n\)</span> 定义的序列 <span class="math inline">\(\{X_n\}\)</span>
是马尔可夫链（马氏链），我们需要验证其是否满足<strong>马尔可夫性（无后效性）</strong>。</p>
<p>即证明： <span class="math display">\[P(X_{n+1} = x_{n+1} | X_n =
x_n, X_{n-1} = x_{n-1}, \cdots, X_0 = x_0) = P(X_{n+1} = x_{n+1} | X_n =
x_n)\]</span></p>
<p>通俗地说，我们要证明：<strong>在已知“现在”(<span
class="math inline">\(X_n\)</span>)的情况下，“未来”(<span
class="math inline">\(X_{n+1}\)</span>)只与“现在”有关，而与“过去”(<span
class="math inline">\(X_{n-1}, \dots\)</span>)无关。</strong></p>
<hr />
<h3 id="证明过程">证明过程</h3>
<p><strong>第一步：分析 <span class="math inline">\(X_{n+1}\)</span>
的构成</strong></p>
<p>根据给定的递推公式，将 <span class="math inline">\(n\)</span> 换成
<span class="math inline">\(n+1\)</span>，我们有： <span
class="math display">\[X_{n+1} = \rho X_n + I_{n+1}\]</span></p>
<p><strong>第二步：分析独立性</strong></p>
<ul>
<li><span class="math inline">\(X_k\)</span> (其中 <span
class="math inline">\(k \le n\)</span>) 是由之前的噪声项 <span
class="math inline">\(I_1, I_2, \cdots, I_k\)</span>
线性组合而成的（因为 <span class="math inline">\(X_0=0\)</span>）。</li>
<li>题目已知 <span class="math inline">\(\{I_n\}\)</span>
是独立同分布的序列。</li>
<li>因此，<strong><span class="math inline">\(I_{n+1}\)</span> 独立于
<span class="math inline">\(I_1, I_2, \cdots,
I_n\)</span></strong>，也就意味着 <strong><span
class="math inline">\(I_{n+1}\)</span> 独立于 <span
class="math inline">\(X_n, X_{n-1}, \cdots, X_0\)</span></strong>。</li>
</ul>
<p><strong>第三步：推导条件概率</strong></p>
<p>我们需要计算在已知所有历史信息的条件下，<span
class="math inline">\(X_{n+1}\)</span> 取特定值的概率：</p>
<p><span class="math display">\[
\begin{aligned}
&amp; P(X_{n+1} = x_{n+1} | X_n = x_n, X_{n-1} = x_{n-1}, \cdots, X_0 =
x_0) \\
&amp; \quad \text{// 代入递推公式 } X_{n+1} = \rho X_n + I_{n+1} \\
=\ &amp; P(\rho X_n + I_{n+1} = x_{n+1} | X_n = x_n, X_{n-1} = x_{n-1},
\cdots, X_0 = x_0) \\
&amp; \quad \text{// 在条件已知的情况下，} X_n \text{ 可以看作常数 } x_n
\\
=\ &amp; P(\rho x_n + I_{n+1} = x_{n+1} | X_n = x_n, X_{n-1} = x_{n-1},
\cdots, X_0 = x_0) \\
&amp; \quad \text{// 移项，将随机变量 } I_{n+1} \text{ 留在左边} \\
=\ &amp; P(I_{n+1} = x_{n+1} - \rho x_n | X_n = x_n, X_{n-1} = x_{n-1},
\cdots, X_0 = x_0) \\
&amp; \quad \text{// 利用独立性：} I_{n+1} \text{ 与过去的 } X \text{
无关，条件可以去掉} \\
=\ &amp; P(I_{n+1} = x_{n+1} - \rho x_n)
\end{aligned}
\]</span></p>
<p><strong>第四步：验证只依赖于当前状态</strong></p>
<p>现在我们需要看看，如果只给定当前状态 <span
class="math inline">\(X_n\)</span>，概率是多少：</p>
<p><span class="math display">\[
\begin{aligned}
&amp; P(X_{n+1} = x_{n+1} | X_n = x_n) \\
=\ &amp; P(\rho X_n + I_{n+1} = x_{n+1} | X_n = x_n) \\
=\ &amp; P(\rho x_n + I_{n+1} = x_{n+1} | X_n = x_n) \\
=\ &amp; P(I_{n+1} = x_{n+1} - \rho x_n | X_n = x_n) \\
&amp; \quad \text{// 同样利用独立性，} I_{n+1} \text{ 与 } X_n \text{
独立} \\
=\ &amp; P(I_{n+1} = x_{n+1} - \rho x_n)
\end{aligned}
\]</span></p>
<p><strong>结论</strong></p>
<p>对比第三步和第四步的结果，我们发现两者完全相等： <span
class="math display">\[
P(X_{n+1} | X_n, \cdots, X_0) = P(I_{n+1} = x_{n+1} - \rho x_n) =
P(X_{n+1} | X_n)
\]</span></p>
<p>这表明，<span class="math inline">\(X_{n+1}\)</span> 的分布仅由 <span
class="math inline">\(X_n\)</span> 的值（以及独立的噪声 <span
class="math inline">\(I_{n+1}\)</span>）决定，与更早的历史状态 <span
class="math inline">\(X_{n-1}, \dots\)</span> 无关。</p>
<p>因此，随机序列 <span class="math inline">\(\{X_n, n=1, 2,
\cdots\}\)</span> <strong>是马尔可夫链</strong>。</p>
<hr />
<h2 id="section-2">3</h2>
<p>这是一道关于<strong>独立增量过程（Random
Walk）</strong>性质证明的经典题目。</p>
<p>要证明一个随机过程是<strong>齐次马尔可夫链</strong>，我们需要验证两个核心条件：
1.
<strong>马尔可夫性（无后效性）</strong>：未来的状态只取决于现在的状态。
2. <strong>齐次性（时不变性）</strong>：转移概率（或转移密度）不随时间
<span class="math inline">\(n\)</span> 的变化而变化。</p>
<p>因为 <span class="math inline">\(Y(n)\)</span> 是独立同分布随机变量
<span class="math inline">\(X(k)\)</span> 的累加和，即 <span
class="math inline">\(Y(n+1) = Y(n) +
X(n+1)\)</span>，这种结构本身就强烈暗示了它是马氏链。</p>
<p>下面针对两种情况分别证明。</p>
<hr />
<h3 id="通用逻辑递推关系">通用逻辑：递推关系</h3>
<p>在这两个小题中，我们都利用同一个递推关系： <span
class="math display">\[Y(n+1) = \sum_{k=1}^{n+1} X(k) = \left(
\sum_{k=1}^{n} X(k) \right) + X(n+1) = Y(n) + X(n+1)\]</span></p>
<p>由于 <span class="math inline">\(\{X(n)\}\)</span>
是相互独立的，所以增量 <span class="math inline">\(X(n+1)\)</span>
独立于过去的所有状态 <span class="math inline">\(Y(n), Y(n-1), \dots,
Y(1)\)</span>。</p>
<hr />
<h3 id="证明当-xn-为伯努利序列时">(1) 证明：当 <span
class="math inline">\(X(n)\)</span> 为伯努利序列时</h3>
<p><strong>1. 验证马尔可夫性</strong> 对于任意的状态序列 <span
class="math inline">\(i_0, i_1, \dots, i, j\)</span>，我们要考察： <span
class="math display">\[P(Y(n+1) = j \mid Y(n) = i, Y(n-1) = i_{n-1},
\dots, Y(1) = i_1)\]</span></p>
<p>代入递推式 <span class="math inline">\(Y(n+1) = Y(n) +
X(n+1)\)</span>： <span class="math display">\[
\begin{aligned}
&amp;= P(Y(n) + X(n+1) = j \mid Y(n) = i, \dots) \\
&amp;= P(i + X(n+1) = j \mid Y(n) = i, \dots) \\
&amp;= P(X(n+1) = j - i \mid Y(n) = i, \dots)
\end{aligned}
\]</span> 由于 <span class="math inline">\(X(n+1)\)</span> 独立于 <span
class="math inline">\(Y(n)\)</span> 及之前的历史，条件可以直接去掉：
<span class="math display">\[= P(X(n+1) = j - i)\]</span> 这等于 <span
class="math inline">\(P(Y(n+1)=j \mid
Y(n)=i)\)</span>。所以，<strong>马尔可夫性成立</strong>。</p>
<p><strong>2. 验证齐次性</strong> 我们需要看转移概率 <span
class="math inline">\(p_{ij}(n) = P(X(n+1) = j-i)\)</span>
是否依赖于时间 <span class="math inline">\(n\)</span>。</p>
<p>由于 <span class="math inline">\(X(n)\)</span>
是<strong>同分布</strong>的伯努利变量，取值只有 0 或 1： * 当 <span
class="math inline">\(j = i\)</span> 时：<span
class="math inline">\(P(X(n+1) = 0) = p\)</span> （原地不动） * 当 <span
class="math inline">\(j = i + 1\)</span> 时：<span
class="math inline">\(P(X(n+1) = 1) = q\)</span> （向前一步） *
其他情况：概率为 0。</p>
<p>可以看出，一步转移概率矩阵中的元素只与 <span class="math inline">\(p,
q\)</span> 有关，与时间 <span class="math inline">\(n\)</span>
无关。</p>
<p><strong>结论</strong>： <span class="math inline">\(\{Y(n)\}\)</span>
是一个状态空间为非负整数的<strong>齐次马尔可夫链</strong>。</p>
<hr />
<h3 id="证明当-xn-sim-nmu-sigma2-时">(2) 证明：当 <span
class="math inline">\(X(n) \sim N(\mu, \sigma^2)\)</span> 时</h3>
<p>这属于连续状态马尔可夫链，我们通过条件概率密度函数（或条件分布函数）来证明。</p>
<p><strong>1. 验证马尔可夫性</strong> 考察在已知历史状态下的条件分布：
<span class="math display">\[P(Y(n+1) \le y \mid Y(n) = x, Y(n-1) =
x_{n-1}, \dots)\]</span></p>
<p>同样利用 <span class="math inline">\(Y(n+1) = Y(n) +
X(n+1)\)</span>： <span class="math display">\[
\begin{aligned}
&amp;= P(Y(n) + X(n+1) \le y \mid Y(n) = x, \dots) \\
&amp;= P(x + X(n+1) \le y \mid Y(n) = x, \dots) \\
&amp;= P(X(n+1) \le y - x)
\end{aligned}
\]</span> 由于独立性，这等于 <span class="math inline">\(P(Y(n+1) \le y
\mid Y(n) = x)\)</span>。所以，<strong>马尔可夫性成立</strong>。</p>
<p><strong>2. 验证齐次性</strong> 我们需要看从状态 <span
class="math inline">\(x\)</span> 转移到区域 <span
class="math inline">\((-\infty, y]\)</span> 的概率（或者转移密度）是否随
<span class="math inline">\(n\)</span> 变化。</p>
<p>由上一步可知，转移概率取决于随机变量 <span
class="math inline">\(X(n+1)\)</span> 的分布。 题目已知 <span
class="math inline">\(X(n) \sim N(\mu, \sigma^2)\)</span>
是<strong>同分布</strong>的。</p>
<p>这意味着对于任何时间 <span
class="math inline">\(n\)</span>，一步转移的概率密度函数始终为： <span
class="math display">\[f(y \mid x) = f_{X}(y - x) =
\frac{1}{\sqrt{2\pi}\sigma} \exp\left\{ -\frac{[(y-x) -
\mu]^2}{2\sigma^2} \right\}\]</span></p>
<p>这个密度函数里的参数 <span class="math inline">\(\mu, \sigma\)</span>
都是常数，不含 <span class="math inline">\(n\)</span>。</p>
<p><strong>结论</strong>： <span class="math inline">\(\{Y(n)\}\)</span>
是一个状态空间为实数轴 <span class="math inline">\(\mathbb{R}\)</span>
的<strong>齐次马尔可夫链</strong>。</p>
<hr />
</body>
</html>
